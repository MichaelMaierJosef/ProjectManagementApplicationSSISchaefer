@using Microsoft.AspNetCore.Identity
@model ProjectManagementApplication.Models.Project
@*
    For more information on enabling MVC for empty projects, visit https://go.microsoft.com/fwlink/?LinkID=397860
*@
@{
}

<style>
    .employee i {
        opacity: 0%;
        transition: opacity .5s;
    }

        .employee i:hover {
            opacity: 100%
        }

    .employee {
        background-color: #EFE407;
    }

    .admin {
        background-color: firebrick;
    }

        .admin i {
            opacity: 0%;
            transition: opacity .5s;
        }

            .admin i:hover {
                opacity: 100%
            }
</style>


<div class="container text-black">
    <div class=" my-2 mx-auto">
        <h3>Neues Projekt</h3>
    </div>
    <form asp-action="CreateEditProject" method="post">
        <input hidden asp-for="id" placeholder="id" />
        <div class="d-flex justify-content-between mt-2 mx-auto">
            <div class="form-outline my-2">
                <input type="text" id="formControlLg" class="form-control form-control-lg" asp-for="projectName" size="30" />
                <label class="form-label" for="formControlLg">Projekt Name</label>
            </div>
            <div class="align-self-end d-flex my-2">
                <h4 class="my-auto me-3">Projektart:</h4>
                <select id="" class="select form-control form-control-lg me-2" asp-for="tense" checked>
                    <option value="active">Aktuell</option>
                    <option value="future">Zukünftig</option>
                    <option value="past">Vergangen</option>
                </select>
            </div>
        </div>

        <h4 class="my-auto me-3 mt-3">Mitarbeiter:</h4>
        <div id="employeeList" class="d-flex my-2 mx-2">
            @{
                List<IdentityUser> projectAdmins = new List<IdentityUser>();
                List<IdentityUser> projectWorker = new List<IdentityUser>();

                if (ViewBag.UserRights != null)
                {
                    foreach (KeyValuePair<IdentityUser, int> entry in ViewBag.UserRights)
                    {
                        if (entry.Value == 0)
                        {
                            projectAdmins.Add(entry.Key);
                        }
                        if (entry.Value == 1)
                        {
                            projectWorker.Add(entry.Key);
                        }
                    }
                }

                foreach (IdentityUser user in projectAdmins)
                {
                    <div id="@user.Id" class="admin d-flex justify-content-around rounded-8 mx-1 my-auto">
                        <button type="submit" class="btn btn-link text-black btn-floating" disabled>
                            <i class="fas fa-times fa-2x"></i>
                        </button>
                        <h5 class="my-auto mx-1">@user.UserName</h5>
                        <button type="button" class="btn btn-link text-black bg-transparent btn-floating">
                            <i class="fas fa-times fa-2x"></i>
                        </button>
                    </div>
                }

                foreach (IdentityUser user in projectWorker)
                {
                    <div id="@user.Id" class="employee d-flex justify-content-around rounded-8 mx-1 my-auto">
                        <button type="submit" class="btn btn-link text-black btn-floating" disabled>
                            <i class="fas fa-times fa-2x"></i>
                        </button>
                        <h5 class="my-auto mx-1">@user.UserName</h5>
                        <button type="button" class="btn btn-link text-black bg-transparent btn-floating">
                            <i class="fas fa-times fa-2x"></i>
                        </button>
                    </div>
                }

            }
            <button type="button" data-mdb-toggle="modal" data-mdb-target="#projectMitarbeiterModal" class="btn btn-link text-black btn-floating">
                <i class="fas fa-plus fa-2x"></i>
            </button>


        </div>

        <h4 class="my-auto me-3 mt-3">Deteils:</h4>
        <div class="d-flex justify-content-between my-3  mx-auto">
            <div class="form-outline flex-fill">
                <textarea class="form-control form-control-lg" asp-for="description" id="textAreaExample" rows="5"></textarea>
                <label class="form-label" for="textAreaExample">Beschreibung</label>
            </div>
        </div>
        <div class="d-flex justify-content-center mt-4 mx-auto">
            <button type="button"
                    onclick="window.location.href = '../'"
                    class="btn btn-lg h-100 mx-5 align-self-end"
                    data-mdb-ripple-color="dark"
                    style="background-color: #EFEDED">
                ABBRECHEN
            </button>

            <button type="submit"
                    class="btn btn-lg h-100 mx-5 align-self-end"
                    data-mdb-ripple-color="dark"
                    style="background-color: #EFE407">
                SPEICHERN
            </button>
        </div>

    </form>


</div>


<div class="modal fade"
     id="projectMitarbeiterModal"
     data-mdb-backdrop="static"
     data-mdb-keyboard="false"
     tabindex="-1"
     aria-labelledby="staticBackdropLabel"
     aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered modal-dialog-scrollable">
        <div class="modal-content">
            <div class="modal-body">
                <div class="container-fluid">
                    <h4>Mitarbeiter Hinzufügen</h4>
                    @{
                        List<IdentityUser> projectAllUser = new List<IdentityUser>();
                        projectAllUser = ViewBag.allUser;
                        <table class="table table-hover">
                            <thead>
                                <tr>
                                    <th>Mitarbeiter</th>
                                    <th>Hinzufügen</th>
                                </tr>
                            </thead>
                            <tbody>
                                @{
                                    if (ViewBag.allUser != null)
                                    {
                                        foreach (IdentityUser user in projectAllUser)
                                        {
                                            <tr>
                                                <th>@user.UserName</th>
                                                <th>
              
                                                    <form method="post" asp-action="EditUserRoles" asp-controller="Project" asp-route-userId="@user.Id" asp-route-ProjectID="@ViewBag.ProjectID">
                                                        <button type="submit" class="btn btn-link text-black btn-floating">
                                                            <i class="fas fa-plus fa-2x"></i>
                                                        </button>
                                                    </form>
                                                </th>
                                            </tr>
                                        }
                                    }
                                }
                            </tbody>
                        </table>
                    }
                    <button type="button" class="btn btn-dark" data-mdb-dismiss="modal">OK</button>
                </div>
            </div>
        </div>
    </div>
</div>

